#!/bin/bash

# ====================================================================
# OMARCHY-INSPIRED SKETCHYBAR CONFIGURATION
# Minimal, modern status bar similar to Waybar/Hyprland
# ====================================================================

# Color Palette (Catppuccin Mocha inspired)
export BLACK=0xff1e1e2e
export WHITE=0xffcdd6f4
export RED=0xfff38ba8
export GREEN=0xffa6e3a1
export BLUE=0xff89b4fa
export YELLOW=0xfff9e2af
export ORANGE=0xfffab387
export MAGENTA=0xffcba6f7
export GREY=0xff6c7086
export TRANSPARENT=0x00000000

# Bar appearance
export BAR_COLOR=0xcc1e1e2e
export BAR_BORDER_COLOR=0xff313244

# ====================================================================
# BAR CONFIGURATION
# ====================================================================

sketchybar --bar \
    position=top \
    height=32 \
    blur_radius=30 \
    color=$BAR_COLOR \
    border_width=2 \
    border_color=$BAR_BORDER_COLOR \
    shadow=on \
    sticky=on \
    padding_left=10 \
    padding_right=10

# ====================================================================
# DEFAULT ITEM STYLES
# ====================================================================

sketchybar --default \
    updates=when_shown \
    icon.font="SF Pro:Semibold:14.0" \
    icon.color=$WHITE \
    icon.padding_left=4 \
    icon.padding_right=4 \
    label.font="SF Pro:Semibold:14.0" \
    label.color=$WHITE \
    label.padding_left=4 \
    label.padding_right=4 \
    padding_left=4 \
    padding_right=4 \
    background.height=24 \
    background.corner_radius=6 \
    background.padding_left=2 \
    background.padding_right=2

# ====================================================================
# LEFT SIDE - SPACES (like Hyprland workspaces)
# ====================================================================

SPACE_ICONS=("1" "2" "3" "4" "5" "6" "7" "8" "9" "10")

for i in "${!SPACE_ICONS[@]}"
do
    sid=$(($i+1))
    sketchybar --add space space.$sid left \
        --set space.$sid \
            associated_space=$sid \
            icon="${SPACE_ICONS[i]}" \
            icon.padding_left=8 \
            icon.padding_right=8 \
            background.color=$TRANSPARENT \
            background.corner_radius=6 \
            background.height=24 \
            background.drawing=on \
            label.drawing=off \
            script="$HOME/.config/sketchybar/plugins/space.sh" \
            click_script="yabai -m space --focus $sid"
done

# Space separator
sketchybar --add item space_separator left \
    --set space_separator \
        icon="│" \
        icon.color=$GREY \
        icon.padding_left=10 \
        icon.padding_right=10 \
        background.drawing=off \
        label.drawing=off

# ====================================================================
# CENTER - WINDOW TITLE
# ====================================================================

sketchybar --add item window_title center \
    --set window_title \
        icon.drawing=off \
        label.font="SF Pro:Bold:14.0" \
        label.color=$BLUE \
        background.drawing=off \
        script="$HOME/.config/sketchybar/plugins/window_title.sh" \
    --subscribe window_title front_app_switched

# ====================================================================
# RIGHT SIDE - SYSTEM INFO
# ====================================================================

# Clock
sketchybar --add item clock right \
    --set clock \
        update_freq=10 \
        icon= \
        icon.color=$BLUE \
        script="$HOME/.config/sketchybar/plugins/clock.sh" \
        background.color=$BLACK \
        background.padding_left=4 \
        background.padding_right=4

# Battery
sketchybar --add item battery right \
    --set battery \
        update_freq=30 \
        script="$HOME/.config/sketchybar/plugins/battery.sh" \
        background.color=$BLACK \
        background.padding_left=4 \
        background.padding_right=4

# CPU
sketchybar --add item cpu right \
    --set cpu \
        update_freq=5 \
        icon=󰘚 \
        icon.color=$GREEN \
        script="$HOME/.config/sketchybar/plugins/cpu.sh" \
        background.color=$BLACK \
        background.padding_left=4 \
        background.padding_right=4

# Memory
sketchybar --add item memory right \
    --set memory \
        update_freq=10 \
        icon= \
        icon.color=$YELLOW \
        script="$HOME/.config/sketchybar/plugins/memory.sh" \
        background.color=$BLACK \
        background.padding_left=4 \
        background.padding_right=4

# ====================================================================
# EVENTS
# ====================================================================

sketchybar --add event window_focus \
           --add event windows_on_spaces \
           --add event title_change \
           --add event space_change \
           --add event display_change

# ====================================================================
# FINALIZE
# ====================================================================

sketchybar --update

echo "SketchyBar configuration loaded!"
